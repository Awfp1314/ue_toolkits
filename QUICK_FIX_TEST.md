# 🧪 快速测试指南 - 光标和选中状态修复

## 快速测试（5 分钟）

### 1️⃣ 启动程序

```bash
python main.py
```

---

### 2️⃣ 测试光标样式

**步骤**：

1. 发送消息："你好"
2. 等待 AI 回复
3. 将鼠标悬停在 AI 回复的文本上

**预期结果**：

- ✅ 光标应该变为 **I-beam 光标**（文本选择光标，|）
- ✅ 不应该是默认箭头光标

**检查日志**：

```
[DEBUG] [UI管理器] 已注册流式气泡到 SelectionManager
```

---

### 3️⃣ 测试选中状态清除 - 点击空白区域

**步骤**：

1. 用鼠标选中 AI 回复中的一段文本
2. 点击聊天窗口的**空白区域**（不是输入框）

**预期结果**：

- ✅ 选中的文本应该**立即取消选中**
- ✅ 不应该还保持蓝色高亮状态

**检查日志**：

```
[SelectionManager] 已清除所有选中状态
```

---

### 4️⃣ 测试选中状态清除 - 点击输入框

**步骤**：

1. 再次选中 AI 回复中的一段文本
2. 点击**输入框**

**预期结果**：

- ✅ 选中的文本应该**立即取消选中**
- ✅ 输入框获得焦点

**检查日志**：

```
[SelectionManager] 已清除所有选中状态
```

---

### 5️⃣ 测试用户消息光标

**步骤**：

1. 发送一条消息
2. 将鼠标悬停在**用户消息气泡**（粉紫色渐变气泡）上

**预期结果**：

- ✅ 光标应该变为 **I-beam 光标**
- ✅ 可以选中用户消息中的文本

---

## 成功标准

所有测试通过，表示修复成功：

- ✅ AI 回复文本：I-beam 光标
- ✅ 用户消息文本：I-beam 光标
- ✅ 点击空白区域：清除选中状态
- ✅ 点击输入框：清除选中状态
- ✅ 日志显示正确的注册和清除信息

---

## 如果测试失败

### 光标样式不正确

**检查**：

1. 查看日志是否有 `[DEBUG] [UI管理器] 已注册流式气泡到 SelectionManager`
2. 如果没有，说明气泡注册失败

**解决方案**：

- 检查 `chat_window.py` 中的 `add_message` 和 `add_streaming_bubble` 方法
- 确保 `CursorStyleManager.set_bubble_cursor()` 被调用

### 选中状态无法清除

**检查**：

1. 点击空白区域时，查看日志是否有 `[SelectionManager] 已清除所有选中状态`
2. 如果没有，说明 `mousePressEvent` 未被触发

**解决方案**：

- 检查 `chat_window.py` 中的 `mousePressEvent` 方法
- 确保 `selection_manager.clear_all_selections()` 被调用

### 选中状态清除但立即恢复

**原因**：

- 可能是事件传播问题

**解决方案**：

- 检查是否有其他组件拦截了鼠标事件
- 确保 `super().mousePressEvent(event)` 在最后调用

---

## 相关文档

- 详细修复说明：`FIX_CURSOR_AND_SELECTION.md`
- 完整测试指南：`TEST_ALL_FIXES.md`

---

**祝测试顺利！** 🎉

如果所有测试都通过，说明光标样式和选中状态问题已经完全修复！
